{% extends "network/layout.html" %}
{% load static %}

{% block body %}
{% block script %}
    <script type="text/javascript" src="{% static 'network/edit.js' %}"></script>
{% endblock %}

    <div class="container-fluid m-3">
        <h2>{{profile.username}}</h2>
        {% if user.is_authenticated and user.id != profile.id %}
        {% if button == "Follow" %}
            <form action="{% url 'follow' user_id=user.id profile_id=profile.id %}">
                <input class="btn btn-secondary" type="submit" id="follow" value="Follow"/>
            </form>
        {% else %}
            <form action="{% url 'unfollow' user_id=user.id profile_id=profile.id %}">
                <input class="btn btn-secondary" type="submit" id="follow" value="Unfollow"/>
            </form>
        {% endif %}
        {% endif %}
        <p>Followers: {{followers}}</p>
        <p>Following: {{following}}</p>

        {% for post in posts %}

        <div class="container-fluid border m-2 p-3">
            <a href="{% url 'profile' post.user %}" class="text-dark"><h4>{{post.user}}</h4></a>
            <div id="post-view-{{post.id}}">
            <span class="my-4" id="post-{{post.id}}">{{post.post}}</span><br>
            {% if user.id == post.user.id %}
            <button class="btn btn-primary btn-sm" id="edit-btn-{{post.id}}" onclick="edit({{post.id}})">Edit</button><br>
            {% endif %}
            </div>
            {% if user.id == post.user.id %}
            <div id="edit-view-{{post.id}}" style="display: none;">
                <textarea class="form-control" id="edit-post-{{post.id}}" name="edit-post">{{post.post}}</textarea>
                <button class="btn btn-primary" id="save-post-{{post.id}}">Save</button>
            </div>
            {% endif %}
            <span class="text-secondary">{{post.date_created}}</span><br>
            <span>❤️ {{post.like_count}}</span><br>
            <span class="text-secondary">Comment</span>
        </div>

        {% endfor %}

    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {% if posts.has_previous %}
                <li class="page-item"><a class="page-link" href="?page=1">&laquo; first</a></li>
                <li class="page-item"><a class="page-link" href="?page={{ posts.previous_page_number }}">Previous</a></li>
            {% endif %}
                <li class="page-item page-link">{{ posts.number }} of {{ posts.paginator.num_pages }}</li>

            {% if posts.has_next %}
                <li class="page-item"><a class="page-link" href="?page={{ posts.next_page_number}}">Next</a></li>
                <li class="page-item"><a class="page-link" href="?page={{ posts.paginator.num_pages }}">last &raquo;</a>
            {% endif %}
        </ul>
      </nav>

    </div>

{% endblock %}
