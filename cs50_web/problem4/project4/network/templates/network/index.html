{% extends "network/layout.html" %}
{% load static %}

{% block body %}
{% block script %}
    <script type="text/javascript" src="{% static 'network/edit.js' %}"></script>
{% endblock %}


    <h2>All Posts</h2>

    {% if user.is_authenticated %}
    <div class="container-fluid border m-2 p-3" style="width: 100%;">
        <form class="form-group" action="{% url 'new_post' %}" method="post">
            {% csrf_token %}
            <label for="new_post" class="font-weight-bold">New Post</label>
            <textarea class="form-control" id="new_post" name="new_post"></textarea>
            <input type="submit" id="post" value="Post" class="btn btn-primary"/>
        </form>
    </div>
    {% endif %}
    {% for post in posts %}

        <div class="container-fluid border m-2 p-3">
            <a href="{% url 'profile' post.user %}" class="text-dark"><h4>{{post.user}}</h4></a>
            <div id="post-view-{{post.id}}">
            <span class="my-4" id="post-{{post.id}}">{{post.post}}</span><br>
            {% if user.id == post.user.id %}
            <button class="btn btn-primary btn-sm" id="edit-btn-{{post.id}}" onclick="edit({{post.id}})">Edit</button><br>
            {% endif %}
            </div>
            {% if user.id == post.user.id %}
            <div id="edit-view-{{post.id}}" style="display: none;">
                <textarea class="form-control" id="edit-post-{{post.id}}" name="edit-post">{{post.post}}</textarea>
                <button class="btn btn-primary" id="save-post-{{post.id}}">Save</button>
            </div>
            {% endif %}
            <span class="text-secondary">{{post.date_created}}</span><br>
            <button {% if user.id != post.user.id %} onclick="like({{post.id}})" {% else %} disabled {% endif %} class="btn" id="like-btn-{{post.id}}" >❤️ </button><span id="like-count-{{post.id}}"> {{post.like_count}}</span><br>
            <span class="text-secondary">Comment</span>
        </div>

    {% endfor %}

    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {% if posts.has_previous %}
                <li class="page-item"><a class="page-link" href="?page=1">&laquo; first</a></li>
                <li class="page-item"><a class="page-link" href="?page={{ posts.previous_page_number }}">Previous</a></li>
            {% endif %}
                <li class="page-item page-link">{{ posts.number }} of {{ posts.paginator.num_pages }}</li>

            {% if posts.has_next %}
                <li class="page-item"><a class="page-link" href="?page={{ posts.next_page_number}}">Next</a></li>
                <li class="page-item"><a class="page-link" href="?page={{ posts.paginator.num_pages }}">last &raquo;</a>
            {% endif %}
        </ul>
      </nav>

    </div>

{% endblock %}
